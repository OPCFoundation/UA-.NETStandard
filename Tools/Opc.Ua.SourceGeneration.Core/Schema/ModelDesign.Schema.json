{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "http://opcfoundation.org/UA/ModelDesign.schema.json",
  "title": "OPC UA Model Design Schema",
  "description": "JSON Schema for OPC UA Model Design definitions. Enables information modellers to define UA types and instances in a machine-readable form.",
  "type": "object",
  "additionalProperties": false,
  "required": [
    "TargetNamespace"
  ],
  "properties": {
    "$schema": {
      "type": "string",
      "description": "JSON Schema version identifier"
    },
    "TargetNamespace": {
      "type": "string",
      "description": "The URI identifying the namespace (required)",
      "format": "uri"
    },
    "TargetVersion": {
      "type": "string",
      "description": "Version of the model"
    },
    "TargetPublicationDate": {
      "type": "string",
      "format": "date-time",
      "description": "Publication date of the model"
    },
    "TargetXmlNamespace": {
      "type": "string",
      "format": "uri",
      "description": "XML namespace URI (if different from TargetNamespace)"
    },
    "DefaultLocale": {
      "type": "string",
      "description": "Default language locale",
      "default": "en"
    },
    "Namespaces": {
      "$ref": "#/definitions/NamespaceTable"
    },
    "PermissionSets": {
      "$ref": "#/definitions/ListOfRolePermissionSet"
    },
    "ObjectTypes": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/ObjectTypeDesign"
      },
      "description": "Object type definitions"
    },
    "VariableTypes": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/VariableTypeDesign"
      },
      "description": "Variable type definitions"
    },
    "ReferenceTypes": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/ReferenceTypeDesign"
      },
      "description": "Reference type definitions"
    },
    "DataTypes": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/DataTypeDesign"
      },
      "description": "Data type definitions"
    },
    "Methods": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/MethodDesign"
      },
      "description": "Method definitions"
    },
    "Objects": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/ObjectDesign"
      },
      "description": "Object instance definitions"
    },
    "Variables": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/VariableDesign"
      },
      "description": "Variable instance definitions"
    },
    "Properties": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/PropertyDesign"
      },
      "description": "Property definitions"
    },
    "Dictionaries": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/DictionaryDesign"
      },
      "description": "Data type dictionary definitions"
    },
    "Views": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/ViewDesign"
      },
      "description": "View definitions"
    },
    "Extensions": {
      "$ref": "#/definitions/ListOfExtensions"
    }
  },
  "definitions": {
    "NamespaceTable": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "Namespaces": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/Namespace"
          },
          "description": "List of namespace definitions"
        }
      }
    },
    "Namespace": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "Uri": {
          "type": "string",
          "format": "uri",
          "description": "The namespace URI"
        },
        "Name": {
          "type": "string",
          "description": "Symbolic name for the namespace that can be used as a variable name"
        },
        "Prefix": {
          "type": "string",
          "description": "The .NET namespace used for the classes produced by the generator"
        },
        "InternalPrefix": {
          "type": "string",
          "description": "The .NET namespace used for classes that are only used within a server application"
        },
        "XmlNamespace": {
          "type": "string",
          "format": "uri",
          "description": "The URI for the XML namespace which the data types belong to if it is different from the model namespace"
        },
        "XmlPrefix": {
          "type": "string",
          "description": "The prefix to be used in the XML file for the XML namespace which the data types belong to"
        },
        "FilePath": {
          "type": "string",
          "description": "The path to the file containing the design file for the namespace"
        },
        "Version": {
          "type": "string",
          "description": "Namespace version"
        },
        "PublicationDate": {
          "type": "string",
          "format": "date",
          "description": "Publication date of the namespace"
        }
      }
    },
    "ListOfExtensions": {
      "type": "array",
      "items": {
        "type": "object",
        "additionalProperties": true,
        "description": "Custom extension metadata"
      }
    },
    "ReleaseStatus": {
      "type": "string",
      "enum": [
        "Released",
        "RC",
        "Draft",
        "Deprecated"
      ],
      "description": "The release status of a node",
      "default": "Released"
    },
    "DataTypePurpose": {
      "type": "string",
      "enum": [
        "Normal",
        "ServicesOnly",
        "CodeGenerator",
        "Testing"
      ],
      "description": "The purpose of a data type",
      "default": "Normal"
    },
    "NodeDesign": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "SymbolicName": {
          "type": "string",
          "description": "Identifies the node within the ModelDesign or containing node"
        },
        "SymbolicId": {
          "type": "string",
          "description": "Globally unique identifier for the node"
        },
        "NumericId": {
          "type": "integer",
          "minimum": 0,
          "description": "Unique numeric ID for the node"
        },
        "StringId": {
          "type": "string",
          "description": "Alternate unique identifier for the node (used instead of NumericId)"
        },
        "IsDeclaration": {
          "type": "boolean",
          "description": "Node is declared elsewhere and no code will be generated",
          "default": false
        },
        "BrowseName": {
          "type": "string",
          "description": "The name used in the information model"
        },
        "DisplayName": {
          "$ref": "#/definitions/LocalizedText"
        },
        "Description": {
          "$ref": "#/definitions/LocalizedText"
        },
        "Children": {
          "$ref": "#/definitions/ListOfChildren"
        },
        "References": {
          "$ref": "#/definitions/ListOfReferences"
        },
        "RolePermissions": {
          "$ref": "#/definitions/RolePermissionSet"
        },
        "DefaultRolePermissions": {
          "$ref": "#/definitions/RolePermissionSet"
        },
        "AccessRestrictions": {
          "$ref": "#/definitions/AccessRestrictions"
        },
        "DefaultAccessRestrictions": {
          "$ref": "#/definitions/AccessRestrictions"
        },
        "WriteAccess": {
          "type": "integer",
          "minimum": 0,
          "description": "Bitmask indicating which attributes are writeable",
          "default": 0
        },
        "PartNo": {
          "type": "integer",
          "minimum": 0,
          "description": "The part that defines the node",
          "default": 0
        },
        "Category": {
          "type": "string",
          "description": "Comma-separated list of categories (e.g., Part4/Services or Part5/StateMachines)"
        },
        "NotInAddressSpace": {
          "type": "boolean",
          "description": "Node is not in the address space",
          "default": false
        },
        "ReleaseStatus": {
          "$ref": "#/definitions/ReleaseStatus"
        },
        "Purpose": {
          "$ref": "#/definitions/DataTypePurpose"
        },
        "IsDynamic": {
          "type": "boolean",
          "description": "Node value may change during runtime",
          "default": false
        },
        "Extensions": {
          "$ref": "#/definitions/ListOfExtensions"
        }
      }
    },
    "TypeDesign": {
      "allOf": [
        {
          "$ref": "#/definitions/NodeDesign"
        },
        {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "SymbolicName": {},
            "SymbolicId": {},
            "NumericId": {},
            "StringId": {},
            "IsDeclaration": {},
            "BrowseName": {},
            "DisplayName": {},
            "Description": {},
            "Children": {},
            "References": {},
            "RolePermissions": {},
            "DefaultRolePermissions": {},
            "AccessRestrictions": {},
            "DefaultAccessRestrictions": {},
            "WriteAccess": {},
            "PartNo": {},
            "Category": {},
            "NotInAddressSpace": {},
            "ReleaseStatus": {},
            "Purpose": {},
            "IsDynamic": {},
            "Extensions": {},
            "ClassName": {
              "type": "string",
              "description": "Name for instances of the type"
            },
            "BaseType": {
              "type": "string",
              "description": "SymbolicId for the BaseType"
            },
            "IsAbstract": {
              "type": "boolean",
              "description": "Whether the type is abstract",
              "default": false
            },
            "NoClassGeneration": {
              "type": "boolean",
              "description": "Suppress class generation for the type",
              "default": false
            }
          }
        }
      ]
    },
    "ObjectTypeDesign": {
      "allOf": [
        {
          "$ref": "#/definitions/TypeDesign"
        },
        {
          "type": "object",
          "properties": {
            "SupportsEvents": {
              "type": "boolean",
              "description": "Whether this object type generates events"
            }
          }
        }
      ]
    },
    "VariableTypeDesign": {
      "allOf": [
        {
          "$ref": "#/definitions/TypeDesign"
        },
        {
          "type": "object",
          "properties": {
            "DataType": {
              "type": "string",
              "description": "The data type of the variable"
            },
            "ValueRank": {
              "$ref": "#/definitions/ValueRank"
            },
            "ArrayDimensions": {
              "type": "string",
              "description": "Dimensions specification for array values"
            },
            "AccessLevel": {
              "$ref": "#/definitions/AccessLevel"
            },
            "MinimumSamplingInterval": {
              "type": "integer",
              "description": "Minimum sampling rate in milliseconds"
            },
            "Historizing": {
              "type": "boolean",
              "description": "Whether the variable supports historical data"
            },
            "ExposesItsChildren": {
              "type": "boolean",
              "description": "Children are exposed in the address space",
              "default": false
            },
            "DefaultValue": {
              "$ref": "#/definitions/DefaultValue"
            }
          }
        }
      ]
    },
    "DataTypeDesign": {
      "allOf": [
        {
          "$ref": "#/definitions/TypeDesign"
        },
        {
          "type": "object",
          "properties": {
            "Fields": {
              "$ref": "#/definitions/ListOfFields"
            },
            "Encodings": {
              "$ref": "#/definitions/ListOfEncodings"
            },
            "IsOptionSet": {
              "type": "boolean",
              "description": "Structure is an option set (bitmask)",
              "default": false
            },
            "IsUnion": {
              "type": "boolean",
              "description": "Structure is a union type",
              "default": false
            },
            "NoArraysAllowed": {
              "type": "boolean",
              "description": "Instances cannot be arrays",
              "default": false
            },
            "ForceEnumValues": {
              "type": "boolean",
              "description": "Force numeric values for enums",
              "default": false
            },
            "NoEncodings": {
              "type": "boolean",
              "description": "Skip encoding generation",
              "default": false
            }
          }
        }
      ]
    },
    "ReferenceTypeDesign": {
      "allOf": [
        {
          "$ref": "#/definitions/TypeDesign"
        },
        {
          "type": "object",
          "properties": {
            "InverseName": {
              "$ref": "#/definitions/LocalizedText"
            },
            "Symmetric": {
              "type": "boolean",
              "description": "Reference type applies in both directions"
            }
          }
        }
      ]
    },
    "InstanceDesign": {
      "allOf": [
        {
          "$ref": "#/definitions/NodeDesign"
        },
        {
          "type": "object",
          "properties": {
            "SymbolicName": {},
            "SymbolicId": {},
            "NumericId": {},
            "StringId": {},
            "IsDeclaration": {},
            "BrowseName": {},
            "DisplayName": {},
            "Description": {},
            "Children": {},
            "References": {},
            "RolePermissions": {},
            "DefaultRolePermissions": {},
            "AccessRestrictions": {},
            "DefaultAccessRestrictions": {},
            "WriteAccess": {},
            "PartNo": {},
            "Category": {},
            "NotInAddressSpace": {},
            "ReleaseStatus": {},
            "Purpose": {},
            "IsDynamic": {},
            "Extensions": {},
            "ReferenceType": {
              "type": "string",
              "description": "Type of reference to parent"
            },
            "Declaration": {
              "type": "string",
              "description": "Reference to the declaration"
            },
            "TypeDefinition": {
              "type": "string",
              "description": "Type definition for the instance"
            },
            "ModellingRule": {
              "$ref": "#/definitions/ModellingRule"
            },
            "MinCardinality": {
              "type": "integer",
              "minimum": 0,
              "description": "Minimum cardinality",
              "default": 0
            },
            "MaxCardinality": {
              "type": "integer",
              "minimum": 0,
              "description": "Maximum cardinality",
              "default": 0
            },
            "PreserveDefaultAttributes": {
              "type": "boolean",
              "description": "Preserve default attributes",
              "default": false
            },
            "DesignToolOnly": {
              "type": "boolean",
              "description": "Definition tool only",
              "default": false
            }
          }
        }
      ]
    },
    "ObjectDesign": {
      "allOf": [
        {
          "$ref": "#/definitions/InstanceDesign"
        },
        {
          "type": "object",
          "properties": {
            "SupportsEvents": {
              "type": "boolean",
              "description": "Whether this object generates events"
            }
          }
        }
      ]
    },
    "VariableDesign": {
      "allOf": [
        {
          "$ref": "#/definitions/InstanceDesign"
        },
        {
          "type": "object",
          "properties": {
            "DataType": {
              "type": "string",
              "description": "The data type of the variable"
            },
            "ValueRank": {
              "$ref": "#/definitions/ValueRank"
            },
            "ArrayDimensions": {
              "type": "string",
              "description": "Dimensions specification for array values"
            },
            "AccessLevel": {
              "$ref": "#/definitions/AccessLevel"
            },
            "InstanceAccessLevel": {
              "$ref": "#/definitions/AccessLevel"
            },
            "MinimumSamplingInterval": {
              "type": "integer",
              "description": "Minimum sampling rate in milliseconds"
            },
            "Historizing": {
              "type": "boolean",
              "description": "Whether the variable supports historical data"
            },
            "DefaultValue": {
              "$ref": "#/definitions/DefaultValue"
            }
          }
        }
      ]
    },
    "PropertyDesign": {
      "allOf": [
        {
          "$ref": "#/definitions/VariableDesign"
        }
      ],
      "description": "A variable which is a property for a node"
    },
    "MethodDesign": {
      "allOf": [
        {
          "$ref": "#/definitions/InstanceDesign"
        },
        {
          "type": "object",
          "properties": {
            "InputArguments": {
              "$ref": "#/definitions/ListOfArguments"
            },
            "OutputArguments": {
              "$ref": "#/definitions/ListOfArguments"
            },
            "NonExecutable": {
              "type": "boolean",
              "description": "Whether the method is executable"
            }
          }
        }
      ]
    },
    "ViewDesign": {
      "allOf": [
        {
          "$ref": "#/definitions/InstanceDesign"
        },
        {
          "type": "object",
          "properties": {
            "SupportsEvents": {
              "type": "boolean",
              "description": "Whether the view generates events",
              "default": false
            },
            "ContainsNoLoops": {
              "type": "boolean",
              "description": "View contains a non-looping hierarchy",
              "default": false
            }
          }
        }
      ]
    },
    "EncodingDesign": {
      "allOf": [
        {
          "$ref": "#/definitions/ObjectDesign"
        }
      ],
      "description": "An object which is a DataTypeEncoding for a DataType"
    },
    "DictionaryDesign": {
      "allOf": [
        {
          "$ref": "#/definitions/VariableDesign"
        },
        {
          "type": "object",
          "required": [
            "EncodingName"
          ],
          "properties": {
            "EncodingName": {
              "type": "string",
              "description": "Reference to the encoding definition"
            }
          }
        }
      ],
      "description": "A variable which is a DataTypeDictionary"
    },
    "AccessRestrictions": {
      "type": "string",
      "enum": [
        "SigningRequired",
        "EncryptionRequired",
        "SessionRequired",
        "SessionWithSigningRequired",
        "SessionWithEncryptionRequired",
        "SigningAndApplyToBrowseRequired",
        "EncryptionAndApplyToBrowseRequired",
        "SessionAndApplyToBrowseRequired",
        "SessionWithSigningAndApplyToBrowseRequired",
        "SessionWithEncryptionAndApplyToBrowseRequired"
      ],
      "description": "Security restrictions applied to a node"
    },
    "Permissions": {
      "type": "string",
      "enum": [
        "Browse",
        "ReadRolePermissions",
        "WriteAttribute",
        "WriteRolePermissions",
        "WriteHistorizing",
        "Read",
        "Write",
        "ReadHistory",
        "InsertHistory",
        "ModifyHistory",
        "DeleteHistory",
        "ReceiveEvents",
        "Call",
        "AddReference",
        "RemoveReference",
        "DeleteNode",
        "AddNode",
        "All",
        "AllRead",
        "None"
      ],
      "description": "Permission granted to a role for a node"
    },
    "RolePermission": {
      "type": "object",
      "required": [
        "Role"
      ],
      "additionalProperties": false,
      "properties": {
        "Role": {
          "type": "string",
          "description": "The role identifier"
        },
        "Permissions": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/Permissions"
          },
          "description": "List of permissions granted to this role"
        }
      }
    },
    "RolePermissionSet": {
      "type": "object",
      "required": [
        "Name"
      ],
      "additionalProperties": false,
      "properties": {
        "Name": {
          "type": "string",
          "description": "Name of the permission set"
        },
        "DoNotInherit": {
          "type": "boolean",
          "description": "Permissions are not inherited by children",
          "default": false
        },
        "RolePermissions": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/RolePermission"
          },
          "description": "Role-based permissions"
        }
      }
    },
    "ListOfRolePermissionSet": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/RolePermissionSet"
      }
    },
    "Reference": {
      "type": "object",
      "required": [
        "ReferenceType",
        "TargetId"
      ],
      "additionalProperties": false,
      "properties": {
        "ReferenceType": {
          "type": "string",
          "description": "Type of the reference"
        },
        "TargetId": {
          "type": "string",
          "description": "SymbolicId of the target node"
        },
        "IsInverse": {
          "type": "boolean",
          "description": "Reference direction is inverted",
          "default": false
        },
        "IsOneWay": {
          "type": "boolean",
          "description": "Only forward reference exists",
          "default": false
        }
      }
    },
    "ListOfReferences": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/Reference"
      }
    },
    "Parameter": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "Name": {
          "type": "string",
          "description": "Parameter name"
        },
        "DataType": {
          "type": "string",
          "description": "Data type of the parameter"
        },
        "ValueRank": {
          "$ref": "#/definitions/ValueRank"
        },
        "ArrayDimensions": {
          "type": "string",
          "description": "Dimensions specification"
        },
        "Description": {
          "$ref": "#/definitions/LocalizedText"
        },
        "DisplayName": {
          "$ref": "#/definitions/LocalizedText"
        },
        "DefaultValue": {
          "$ref": "#/definitions/DefaultValue"
        },
        "Identifier": {
          "type": "number",
          "description": "Unique numeric identifier"
        },
        "BitMask": {
          "type": "string",
          "description": "Named bitmask for flag fields"
        },
        "AllowSubTypes": {
          "type": "boolean",
          "description": "Subtypes are allowed",
          "default": false
        },
        "IsOptional": {
          "type": "boolean",
          "description": "Parameter is optional",
          "default": false
        },
        "ReleaseStatus": {
          "$ref": "#/definitions/ReleaseStatus"
        }
      }
    },
    "ListOfArguments": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/Parameter"
      },
      "description": "List of method arguments"
    },
    "ListOfFields": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/Parameter"
      },
      "description": "List of data type fields"
    },
    "ListOfEncodings": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/EncodingDesign"
      },
      "description": "List of data type encodings"
    },
    "ListOfChildren": {
      "type": "array",
      "items": {
        "oneOf": [
          {
            "$ref": "#/definitions/ObjectDesign"
          },
          {
            "$ref": "#/definitions/VariableDesign"
          },
          {
            "$ref": "#/definitions/PropertyDesign"
          },
          {
            "$ref": "#/definitions/MethodDesign"
          }
        ]
      },
      "description": "Child nodes (properties, components, methods)"
    },
    "LocalizedText": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "Value": {
          "type": "string",
          "description": "The localized text value"
        },
        "Key": {
          "type": "string",
          "description": "Resource key for locale lookup"
        },
        "DoNotIgnore": {
          "type": "boolean",
          "description": "Do not ignore this localized text",
          "default": false
        }
      }
    },
    "DefaultValue": {
      "type": "object",
      "additionalProperties": true,
      "description": "Default value for a node (supports any type)"
    },
    "AccessLevel": {
      "type": "string",
      "enum": [
        "None",
        "Read",
        "Write",
        "ReadWrite",
        "HistoryRead",
        "HistoryWrite",
        "HistoryReadWrite"
      ],
      "description": "Access level for a variable",
      "default": "Read"
    },
    "ValueRank": {
      "type": "string",
      "enum": [
        "Scalar",
        "Array",
        "ScalarOrArray",
        "OneOrMoreDimensions",
        "ScalarOrOneDimension",
        "Any"
      ],
      "description": "Value rank for a variable",
      "default": "Scalar"
    },
    "ModellingRule": {
      "type": "string",
      "enum": [
        "None",
        "Mandatory",
        "Optional",
        "ExposesItsArray",
        "CardinalityRestriction",
        "MandatoryShared",
        "OptionalPlaceholder",
        "MandatoryPlaceholder"
      ],
      "description": "Modelling rule for an instance"
    }
  }
}
